var O=Object.defineProperty,w=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var f=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var l=(a,n,e)=>n in a?O(a,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[n]=e,s=(a,n)=>{for(var e in n||(n={}))b.call(n,e)&&l(a,e,n[e]);if(f)for(var e of f(n))E.call(n,e)&&l(a,e,n[e]);return a},o=(a,n)=>w(a,I(n));var m=(a,n,e)=>new Promise((t,u)=>{var T=i=>{try{y(e.next(i))}catch(d){u(d)}},c=i=>{try{y(e.throw(i))}catch(d){u(d)}},y=i=>i.done?t(i.value):Promise.resolve(i.value).then(T,c);y((e=e.apply(a,n)).next())});import P from"querystring-number";var g={},h=(t,u,...T)=>m(void 0,[t,u,...T],function*(a,n,e={}){if(typeof window=="undefined")return;let c;e.method==="GET"?a+="?"+P.stringify(c):c=n&&JSON.stringify(n);let y=(e.baseUrl||"")+a,i=y+c;if(e.cacheTime){let r=g[i];if(r&&Date.now()-r.time<e.cacheTime)return r}let d=Object.prototype.toString.call(n)==="[object FormData]";return e.headers||(e.headers={}),e.headers["Content-Type"]||(d?e.headers["Content-Type"]="application/x-www-form-urlencoded":e.headers["Content-Type"]="application/json"),e.method==="GET"&&!e.headers["Cache-Control"]&&(e.headers["Cache-Control"]="public, max-age=604800, immutable"),fetch(y,o(s({body:c},e),{headers:e.headers})).then(r=>m(void 0,null,function*(){return{body:yield r[e.format||"json"](),status:r.status,headers:r.headers}})).then(r=>m(void 0,null,function*(){return e.cacheTime&&(g[i]={data:r,time:Date.now()}),e.reduce&&(r=yield Promise.resolve(e.reduce(r))),e.onSuccess&&(yield Promise.resolve(e.onSuccess(r))),r})).catch(r=>m(void 0,null,function*(){e.onError&&(yield Promise.resolve(e.onError(r)))}))}),v=(a={})=>({get:(n,e,t)=>h(n,e,o(s(s({},a),t),{method:"GET"})),post:(n,e,t)=>h(n,e,o(s(s({},a),t),{method:"POST"})),put:(n,e,t)=>h(n,e,o(s(s({},a),t),{method:"PUT"})),del:(n,e,t)=>h(n,e,o(s(s({},a),t),{method:"DELETE"})),options:(n,e,t)=>h(n,e,o(s(s({},a),t),{method:"OPTIONS"}))});export{h as baseApi,v as createHttp};
