import querystring from"querystring-number";var __assign=function(){return(__assign=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function __awaiter(a,i,s,c){return new(s=s||Promise)(function(e,n){function t(e){try{o(c.next(e))}catch(e){n(e)}}function r(e){try{o(c.throw(e))}catch(e){n(e)}}function o(n){n.done?e(n.value):new s(function(e){e(n.value)}).then(t,r)}o((c=c.apply(a,i||[])).next())})}function __generator(t,r){var o,a,i,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},e={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(i=2&n[0]?a.return:n[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,n[1])).done)return i;switch(a=0,(n=i?[2&n[0],i.value]:n)[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,a=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=r.call(t,s)}catch(e){n=[6,e],a=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,e])}}}var cache={},baseApi=function(i,s,c){return void 0===c&&(c={}),__awaiter(void 0,void 0,void 0,function(){var n,t,r,o,a;return __generator(this,function(e){return n=void 0,r="",t=c.useCache,"GET"===c.method?r="?"+querystring.stringify(s):n=s&&JSON.stringify(s),r=(c.baseUrl||"")+i+r,o=r+n,t&&(a=cache[o])&&Date.now()-a.time<(c.cacheTimeout||9e5)?[2,a]:(a="[object FormData]"===Object.prototype.toString.call(s),c.headers||(c.headers={}),c.headers["Content-Type"]||(c.headers["Content-Type"]=a?"application/x-www-form-urlencoded":"application/json"),"GET"!==c.method||c.headers["Cache-Control"]||(c.headers["Cache-Control"]="public, max-age=604800, immutable"),[2,fetch(r,__assign(__assign({body:n},c),{headers:c.headers})).then(function(e){return e[c.format||"json"]()}).then(function(n){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return t&&(cache[o]={data:n,time:Date.now()}),c.reduce?[4,Promise.resolve(c.reduce(n))]:[3,2];case 1:n=e.sent(),e.label=2;case 2:return c.onSuccess?[4,Promise.resolve(c.onSuccess(n))]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2,n]}})})}).catch(function(n){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return c.onError?[4,Promise.resolve(c.onError(n))]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})])})})},createHttp=function(r){return void 0===r&&(r={}),{get:function(e,n,t){return baseApi(e,n,__assign(__assign(__assign({},r),t),{method:"GET"}))},post:function(e,n,t){return baseApi(e,n,__assign(__assign(__assign({},r),t),{method:"POST"}))},del:function(e,n,t){return baseApi(e,n,__assign(__assign(__assign({},r),t),{method:"DELETE"}))},options:function(e,n,t){return baseApi(e,n,__assign(__assign(__assign({},r),t),{method:"OPTIONS"}))}}},createZeroApi=function(t,e){var r=createHttp({onError:e});return new Proxy({},{get:function(e,n){return e[n]||(e[n]=function(e){return r.post(t+"/"+n,e)}),e[n]}})};export{baseApi,createHttp,createZeroApi};
//# sourceMappingURL=index.js.map
